function [dQ, x, psi, t, Q] = gradient(tau1, tau2, h0, u0, M, R, I, g, l, a_max, x0)
% TODO -> different ength of tau1 and tau2

[t, x, u_out, n, dtau, cn] = solver_BB(h0, tau1, tau2, u0, M, R, I, g, l, a_max, x0);
[t,psi] = solver_a_BB(n,dtau, cn, x, t, u_out, M, R, I, g, l, a_max, xf, k);


dQ = zeros(1, length(tau1)+length(tau2));
for i = 1:length_p
    dQ(i) = psi(t == x(i), 4);
end
for i = length_p+1:length(x)
    dQ(i) = psi(t == x(i), 8);
end

Q = (k*x(9)+(x(1:8)-xf)*(x(1:8)-xf)')/2;